<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>PayloadIdentifier</key>
	<string>com.domain.macadmin.ExtensionsAllowList</string>
	<key>autoremove</key>
	<false/>
	<key>catalogs</key>
	<array>
		<string>Faculty</string>
		<string>Kiosk</string>
		<string>Lab</string>
		<string>Staff</string>
		<string>Testing</string>
	</array>
	<key>category</key>
	<string>Prefs</string>
	<key>description</key>
	<string>Adds out Enterprise account Team ID to allow non notarized apps and packages we sign in Catalina</string>
	<key>developer</key>
	<string>MacAdmins</string>
	<key>display_name</key>
	<string>ExtensionsAllowList</string>
	<key>icon_name</key>
	<string>Preferences.png</string>
	<key>installcheck_script</key>
	<string>#!/bin/bash

if [[ ! `profiles list | grep com.domain.macadmin.ExtensionsAllowList` ]]; then
	exit 0
else
    exit 1
fi</string>
	<key>installer_type</key>
	<string>nopkg</string>
	<key>minimum_munki_version</key>
	<string>2.2</string>
	<key>minimum_os_version</key>
	<string>10.14</string>
	<key>name</key>
	<string>ExtensionsAllowList</string>
	<key>notes</key>
	<string>MDM InstallProfile</string>
	<key>postinstall_script</key>
	<string>#!/bin/bash

DEVICE=`ioreg -d2 -c IOPlatformExpertDevice | awk -F\" '/IOPlatformUUID/{print $(NF-1)}'`

curl --request POST \
  --url https://middleware.domain.com/api/InstallProfile \
  --header 'authorization: Basic XXXXXXXXXXXXXXX' \
  --header 'content-type: application/json; charset=utf-8' \
  --data '{
	"request_type" : "InstallProfile",
	"udid" : "'"$DEVICE"'",
	"payload" : 
	"MIAGCSqGSIb3DQEHAqCAMIACAQExDzANBglghkgBZQMEAgEFADCABgkqhkiG9w0BBwGggCSABIIG3Tw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+DTwhRE9DVFlQRSBwbGlzdCBQVUJMSUMgIi0vL0FwcGxlLy9EVEQgUExJU1QgMS4wLy9FTiIgImh0dHA6Ly93d3cuYXBwbGUuY29tL0RURHMvUHJvcGVydHlMaXN0LTEuMC5kdGQiPg08cGxpc3QgdmVyc2lvbj0iMS4wIj4NPGRpY3Q+DQk8a2V5PlBheWxvYWRDb250ZW50PC9rZXk+DQk8YXJyYXk+DQkJPGRpY3Q+DQkJCTxrZXk+QWxsb3dlZEtlcm5lbEV4dGVuc2lvbnM8L2tleT4NCQkJPGRpY3Q+DQkJCQk8a2V5PkVHMjc3NjZEWTc8L2tleT4NCQkJCTxhcnJheT4NCQkJCQk8c3RyaW5nPmNvbS53YWNvbS5rZXh0LndhY29tdGFibGV0PC9zdHJpbmc+DQkJCQkJPHN0cmluZz5jb20uc2lsYWJzLmRyaXZlci5DUDIxMHhWQ1BEcml2ZXI2NDwvc3RyaW5nPg0JCQkJCTxzdHJpbmc+Y29tLkZUREkuZHJpdmVyLkQyWFhIZWxwZXI8L3N0cmluZz4NCQkJCTwvYXJyYXk+DQkJCTwvZGljdD4NCQkJPGtleT5BbGxvd2VkVGVhbUlkZW50aWZpZXJzPC9rZXk+DQkJCTxhcnJheT4NCQkJCTxzdHJpbmc+N1RGNkNTUDgzUzwvc3RyaW5nPg0JCQkJPHN0cmluZz5FRzdLSDY0Mlg2PC9zdHJpbmc+DQkJCQk8c3RyaW5nPkVHMjc3NjZEWTc8L3N0cmluZz4NCQkJCTxzdHJpbmc+WEUyWE5SUlhaNTwvc3RyaW5nPg0JCQkJPHN0cmluZz45VTM2Q1FMM1JTPC9zdHJpbmc+DQkJCQk8c3RyaW5nPlJVNExXN1czMkM8L3N0cmluZz4NCQkJPC9hcnJheT4NCQkJPGtleT5QYXlsb2FkRGlzcGxheU5hbWU8L2tleT4NCQkJPHN0cmluZz5FeHRlbnNpb24gU2V0dGluZ3M8L3N0cmluZz4NCQkJPGtleT5QYXlsb2FkRW5hYmxlZDwva2V5Pg0JCQk8dHJ1ZS8+DQkJCTxrZXk+UGF5bG9hZElkZW50aWZpZXI8L2tleT4NCQkJPHN0cmluZz5jYS5lY3VhZC5tYWN0ZWNoLkV4dGVuc2lvbnNBbGxvd0xpc3QuQWxsb3dlZEV4dGVuc2lvbnM8L3N0cmluZz4NCQkJPGtleT5QYXlsb2FkVHlwZTwva2V5Pg0JCQk8c3RyaW5nPmNvbS5hcHBsZS5zeXNwb2xpY3kua2VybmVsLWV4dGVuc2lvbi1wb2xpY3k8L3N0cmluZz4NCQkJPGtleT5QYXlsb2FkVVVJRDwva2V5Pg0JCQk8c3RyaW5nPmRjNTAxYzkwLTIwMmYtMDEzNi0xNWI3LTEwZGRiMWU0NDZiZDwvc3RyaW5nPg0JCQk8a2V5PlBheWxvYWRWZXJzaW9uPC9rZXk+DQkJCTxpbnRlZ2VyPjE8L2ludGVnZXI+DQkJPC9kaWN0Pg0JPC9hcnJheT4NCTxrZXk+UGF5bG9hZERpc3BsYXlOYW1lPC9rZXk+DQk8c3RyaW5nPkV4dGVuc2lvbnNBbGxvd0xpc3Q8L3N0cmluZz4NCTxrZXk+UGF5bG9hZEVuYWJsZWQ8L2tleT4NCTx0cnVlLz4NCTxrZXk+UGF5bG9hZElkZW50aWZpZXI8L2tleT4NCTxzdHJpbmc+Y2EuZWN1YWQubWFjYWRtaW4uRXh0ZW5zaW9uc0FsbG93TGlzdDwvc3RyaW5nPg0JPGtleT5QYXlsb2FkT3JnYW5pemF0aW9uPC9rZXk+DQk8c3RyaW5nPkVtaWx5Q2FyclVuaXZlcnNpdHk8L3N0cmluZz4NCTxrZXk+UGF5bG9hZFJlbW92YWxEaXNhbGxvd2VkPC9rZXk+DQk8ZmFsc2UvPg0JPGtleT5QYXlsb2FkU2NvcGU8L2tleT4NCTxzdHJpbmc+U3lzdGVtPC9zdHJpbmc+DQk8a2V5PlBheWxvYWRUeXBlPC9rZXk+DQk8c3RyaW5nPkNvbmZpZ3VyYXRpb248L3N0cmluZz4NCTxrZXk+UGF5bG9hZFVVSUQ8L2tleT4NCTxzdHJpbmc+OTk3RDNDNEQtRDQzRS00MjZFLUE5MTYtMzhCQzg1MDkyRjAyPC9zdHJpbmc+DQk8a2V5PlBheWxvYWRWZXJzaW9uPC9rZXk+DQk8aW50ZWdlcj4xPC9pbnRlZ2VyPg08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"
}'</string>
	<key>unattended_install</key>
	<true/>
	<key>unattended_uninstall</key>
	<true/>
	<key>uninstall_method</key>
	<string>uninstall_script</string>
	<key>uninstall_script</key>
	<string>#!/bin/bash

DEVICE=`ioreg -d2 -c IOPlatformExpertDevice | awk -F\" '/IOPlatformUUID/{print $(NF-1)}'`

curl --request POST \
  --url https://middleware.domain.com/api/RemoveProfile \
  --header 'authorization: Basic XXXXXXXXXXXXXXX' \
  --header 'content-type: application/json; charset=utf-8' \
  --data '{
	"request_type" : "RemoveProfile",
	"identifier" : "com.domain.macadmin.ExtensionsAllowList",
	"udid" : "'"$DEVICE"'"
}'</string>
	<key>uninstallable</key>
	<true/>
	<key>version</key>
	<string>10.15</string>
</dict>
</plist>
